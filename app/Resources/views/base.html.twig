<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{% block title %}Recolnat Diff{% endblock %}</title>
        {% block stylesheets %}{% endblock %}
        <link rel="icon" type="image/x-icon" href="{{ asset('favicon.ico') }}" />
{#        <link rel="stylesheet" href="{{ asset('bootstrap/3.3.5/css/bootstrap.min.css') }}">
        <link rel="stylesheet" href="{{ asset('bootstrap/3.3.5/css/bootstrap-theme.min.css') }}">#}
        <link rel="stylesheet" href="http://explore.recolnat.org/resources/css/app.css">
        <link rel="stylesheet" href="http://explore.recolnat.org/resources/css/bootstrap/bootstrap.and.theme.css">
        <link rel="stylesheet" href="{{ asset('AppBundle/css/custom.css') }}">
    </head>
    <body>
        <div class="container-fluid">
            
        {% block body %}{% endblock %}
        </div>
{#<div class="modal"><!-- Place at bottom of page --></div>#}
    <div class="modal fade" id="spinnerModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body" >
                    <div style="height:200px">
                      <span id="searching_spinner_center" style="position: absolute;display: block;top: 50%;left: 50%;"><img src="{{ asset('AppBundle/images/load.gif') }}" alt="" /></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </body>
    <script src="//code.jquery.com/jquery.min.js"></script>
    <script src="{{ asset('bootstrap/3.3.5/js/bootstrap.min.js') }}"></script>
    <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
    <script src="{{ asset('AppBundle/js/string.js') }}"></script>
    <script src="{{ asset('AppBundle/js/jquery.toaster.js') }}"></script>
    <script src="{{ path('fos_js_routing_js', {'callback': 'fos.Router.setData'}) }}"></script>
        {% block javascripts %}
        
        {% endblock %}
        <script type="text/javascript">
            $(document).ready(function(){
                var modal = $("#spinnerModal") ;
                $.toaster({ settings : {
                    'timeout' : 5000,
                    'toaster'         :
                        {
                            'css'       :
                            {
                                'position' : 'fixed',
                                'top'      : '10px',
                                'right'    : '10px',
                                'width'    : '350px',
                                'zIndex'   : 50000
                            }
                        }
                } });
               $(document).ajaxStart(function () {
                    modal.modal('show');
                })
                .ajaxStop(function () {
                  modal.modal('hide');
              })
                .ajaxComplete(function(event, xhr, settings) {
                try {
                    var data = $.parseJSON(xhr.responseText);

                    if (data.messages) {
                        var messages = data.messages;

                        var i;

                        if (messages.warning) {
                            for (i = 0; i < messages.warning.length; i++) {
                                $.toaster({ message : messages.warning[i], priority : 'warning', title : '{{ 'label.warning' | trans}}' });
                            }
                        }

                        if (messages.error) {
                            for (i = 0; i < messages.error.length; i++) {
                                $.toaster({ message : messages.error[i], priority : 'danger', title : '{{ 'label.danger' | trans}}' });
                            }
                        }

                        if (messages.success) {
                            for (i = 0; i < messages.success.length; i++) {
                                $.toaster({ message : messages.success[i],  priority : 'success', title : '{{ 'label.success' | trans}}' });
                            }
                        }

                        if (messages.info) {
                            for (i = 0; i < messages.info.length; i++) {
                                $.toaster({ message : messages.info[i], priority : 'info', title : '{{ 'label.info' | trans}}' });
                            }
                        }
                    }
                } catch (e) {
                    
                }
            });
          });
          $(document).ready(function(){
            $('#maxItemPerPage').change(function(){
                    {% set currentPath = path(app.request.attributes.get('_route')) %}
                    var url = "{{path(app.request.attributes.get('_route'),{'maxItemPerPage': '_itemNum'})}}";
                    maxItemPerPage = $('#maxItemPerPage').find(":selected").text();
                    localStorage.setItem('maxItemPerPage', maxItemPerPage);
                    jQuery(location).attr('href', url.replace('_itemNum',maxItemPerPage));
                });
        });

        </script>
</html>
